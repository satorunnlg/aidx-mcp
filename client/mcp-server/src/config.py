"""AIDX MCP Server 設定"""
import os
from pathlib import Path

# CAD接続設定
CAD_TYPE = os.getenv("AIDX_CAD_TYPE", "fusion360")
CAD_PORTS = {
    "fusion360": 8109,
    "autocad": 8110  # 同時起動時は別ポート
}

AIDX_HOST = "127.0.0.1"
AIDX_PORT = int(os.getenv("AIDX_PORT", CAD_PORTS.get(CAD_TYPE, 8109)))

# タイムアウト設定（秒）
CONNECT_TIMEOUT = 10
RECV_TIMEOUT = 30
COMMAND_TIMEOUT = 300

# 接続リトライ設定
CONNECT_RETRY_MAX = 10      # 最大リトライ回数
CONNECT_RETRY_INTERVAL = 3  # リトライ間隔（秒）

# プロトコル定数
AIDX_MAGIC = 0x41494458
CHUNK_SIZE = 64 * 1024  # 64KB

# コマンドID
CMD_PING = 0x0001
CMD_SCREENSHOT = 0x0100
CMD_IMPORT_FILE = 0x0200
CMD_GET_OBJECTS = 0x0300
CMD_MODIFY = 0x0400
CMD_CREATE_OBJECT = 0x0500
CMD_DELETE_OBJECT = 0x0600
CMD_ERROR = 0xFFFF

# エラーコード
ERR_PARSE_ERROR = 0x1000
ERR_INVALID_COMMAND = 0x1001
ERR_INVALID_PAYLOAD = 0x1002
ERR_INVALID_SEQUENCE = 0x1003
ERR_EXECUTION_ERROR = 0x2000
ERR_FILE_NOT_FOUND = 0x2001
ERR_IMPORT_FAILED = 0x2002
ERR_OBJECT_NOT_FOUND = 0x2003
ERR_OPERATION_FAILED = 0x2004
ERR_INVALID_PARAMETER = 0x2005
ERR_TIMEOUT = 0x3000
ERR_RESOURCE_BUSY = 0x3001

# ログ設定
LOG_DIR = Path(__file__).parent.parent / "logs"
LOG_FILE = LOG_DIR / f"mcp_server_{CAD_TYPE}.log"
LOG_MAX_BYTES = 10 * 1024 * 1024  # 10MB
LOG_BACKUP_COUNT = 5  # ローテーション数
